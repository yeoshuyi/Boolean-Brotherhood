<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Choose a Location</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      /* TikTok core */
      --tt-black:#0f0f0f;
      --tt-ink:#ffffff;
      --tt-muted:#bfbfbf;
      --tt-teal:#69C9D0;
      --tt-pink:#EE1D52;

      /* Surfaces */
      --panel:#141414;
      --line:#262626;

      /* Effects */
      --shadow-1: 0 10px 30px rgba(0,0,0,.35);
      --radius-outer: 18px;
      --radius-inner: 14px;

      --rail-w: clamp(140px, 14vw, 260px);
      --content-w: min(1100px, 88vw);
    }

    *,*::before,*::after{ box-sizing:border-box }
    html, body { height: 100%; }
    body{
      margin:0;
      background:
        radial-gradient(1200px 1200px at 20% -10%, rgba(105,201,208,.16), transparent 40%),
        radial-gradient(1200px 1200px at 80% 110%, rgba(238,29,82,.16), transparent 40%),
        var(--tt-black);
      color: var(--tt-ink);
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans";
      -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
    }

    /* Side rails */
    .rail{
      position: fixed; inset: 0 auto 0 0; width: var(--rail-w);
      pointer-events: none; z-index: 0;
      background: linear-gradient(180deg, rgba(105,201,208,.08), transparent 30%, transparent 70%, rgba(238,29,82,.08));
      border-right: 1px solid #1f1f1f;
    }
    .rail--right{ left:auto; right:0; border-right:none; border-left:1px solid #1f1f1f; }
    .rail__canvas{ position:absolute; inset:0; width:100%; height:100%; display:block; pointer-events:auto; }

    /* Page */
    .page{
      position:relative; z-index:1;
      width: var(--content-w);
      margin: 0 auto;
      padding: clamp(22px, 3.5vw, 40px) 0 96px;
      display:grid; gap: 20px;
    }

    /* Header */
    .hero{
      display:grid; gap: 10px;
      background: linear-gradient(180deg, #141414, #0f0f0f);
      border: 1px solid var(--line);
      border-radius: var(--radius-outer);
      box-shadow: var(--shadow-1);
      padding: 26px;
      text-align:center;
    }
    h1{
      margin:0;
      font-size: clamp(1.5rem, 3.6vw, 2.3rem);
      line-height:1.15; letter-spacing:.3px;
      background: linear-gradient(90deg, var(--tt-teal), var(--tt-pink));
      -webkit-background-clip:text; background-clip:text; -webkit-text-fill-color:transparent;
      text-shadow: 0 0 18px rgba(105,201,208,.25), 0 0 22px rgba(238,29,82,.18);
    }
    .sub{ margin:0; color:var(--tt-muted); }

    /* List card */
    .card{
      background: var(--panel);
      border: 1px solid var(--line);
      border-radius: var(--radius-outer);
      box-shadow: var(--shadow-1);
      overflow: clip;
    }
    .card-head{
      padding: 16px 20px;
      border-bottom:1px solid var(--line);
      background: #171717;
      text-align:center;
      color:#eaeaea;
      font-weight:700;
    }

    form{ margin:0; }
    .list{
      list-style:none; margin:0; padding: 14px;
      display:grid; gap:12px;
      max-height: min(60vh, 560px);
      overflow:auto; scrollbar-width: thin;
      background: linear-gradient(180deg, #121212 0%, #0f0f0f 100%);
    }
    .list::-webkit-scrollbar{ width:10px; }
    .list::-webkit-scrollbar-thumb{ background:#2b2b2b; border-radius:999px; }

    /* Item button */
    .item-btn{
      width:100%; text-align:left; cursor:pointer; border:1px solid #242424;
      background:#131313; color:#f5f5f5;
      border-radius:12px; padding:14px 16px;
      display:grid; gap:6px; line-height:1.25;
      transition: transform .12s ease, box-shadow .2s ease, border-color .2s ease, background .2s ease;
      box-shadow: 0 6px 20px rgba(0,0,0,.25);
      position:relative;
    }
    .item-btn:hover{
      transform: translateY(-1px);
      border-color: rgba(105,201,208,.45);
      box-shadow: 0 10px 28px rgba(238,29,82,.18), 0 0 0 1px rgba(105,201,208,.12) inset;
      background:#151515;
    }
    .item-btn:focus-visible{
      outline: none;
      box-shadow:
        0 0 0 2px rgba(105,201,208,.5),
        0 0 0 6px rgba(238,29,82,.25);
    }
    .item-btn:active{ transform: translateY(0); }

    .name{ font-weight:800; font-size:1rem; letter-spacing:.2px; }
    .addr{ color:#d4d4d4; font-size:.92rem; }

    /* Chevron accent */
    .item-btn::after{
      content: "â€º"; position:absolute; right:14px; top:50%; transform: translateY(-50%);
      font-size:1.2rem; color:#9e9e9e; transition: transform .12s ease;
    }
    .item-btn:hover::after{ transform: translateY(-50%) translateX(3px); }

    /* Entrance */
    @keyframes slideIn { from { opacity:0; transform: translateY(6px); } to { opacity:1; transform: translateY(0); } }
    li{ animation: slideIn .45s ease both; }
    li:nth-child(2){ animation-delay:.04s } li:nth-child(3){ animation-delay:.08s }
    li:nth-child(4){ animation-delay:.12s } li:nth-child(5){ animation-delay:.16s }

    /* Responsive */
    @media (max-width: 860px){ .rail{ display:none; } }
  </style>
</head>
<body>
  <!-- Interactive neon rails (same 3D style/colors as the reviewer page) -->
  <aside class="rail" aria-hidden="true"><canvas id="railLeft" class="rail__canvas"></canvas></aside>
  <aside class="rail rail--right" aria-hidden="true"><canvas id="railRight" class="rail__canvas"></canvas></aside>

  <main class="page">
    <section class="hero">
      <h1>Multiple Locations Found!</h1>
      <p class="sub">Pick the exact one you meant ðŸ‘‡</p>
    </section>

    <section class="card">
      <div class="card-head">Choose a Location</div>
      <form action="/submit2" method="POST" aria-label="Location choices">
        <ul class="list">
          {% for place in value %}
            <li>
              <button
                class="item-btn"
                name="a"
                id="{{ place['place_id'] }}"
                type="submit"
                value="{{ place['place_id'] }}"
                aria-label="Choose {{ place['name'] }} at {{ place['formatted_address'] }}"
              >
                <span class="name">{{ place['name'] }}</span>
                <span class="addr">{{ place['formatted_address'] }}</span>
              </button>
            </li>
          {% endfor %}
        </ul>
      </form>
    </section>
  </main>

  <!-- Three.js side-rail shapes (torus, torus-knot, icosahedron) in TikTok colors -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
  <script>
  function makeRail(canvas, side='left'){
    const renderer = new THREE.WebGLRenderer({ canvas, antialias:true, alpha:true });
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(55, canvas.clientWidth/canvas.clientHeight, 0.1, 100);
    camera.position.set(side==='left' ? 2.4 : -2.4, 0.4, 4.6);
    camera.lookAt(0,0,0);

    // Lights
    scene.add(new THREE.AmbientLight(0xffffff, .35));
    const key = new THREE.DirectionalLight(0xffffff,.9);
    key.position.set(side==='left'?-4:4,6,4);
    scene.add(key);

    // Materials (TikTok colors)
    const matTeal = new THREE.MeshStandardMaterial({ color:0x69C9D0, emissive:0x0a3d42, emissiveIntensity:.2, metalness:.6, roughness:.35 });
    const matPink = new THREE.MeshStandardMaterial({ color:0xEE1D52, emissive:0x3a0a17, emissiveIntensity:.22, metalness:.6, roughness:.34 });
    const matDark = new THREE.MeshStandardMaterial({ color:0x1a1a1a, metalness:.35, roughness:.6 });

    // Root group so we can rotate the whole cluster toward the cursor
    const root = new THREE.Group();
    scene.add(root);

    // Shapes
    const torus = new THREE.Mesh(new THREE.TorusGeometry(1.1,0.26,28,180), matTeal);
    const knot  = new THREE.Mesh(new THREE.TorusKnotGeometry(0.9,0.18,180,24), matPink);
    const ico   = new THREE.Mesh(new THREE.IcosahedronGeometry(0.86,0), matDark);

    torus.position.set(side==='left'?-1.2:1.2, 0.25, -0.15);
    knot.position.set(side==='left'?-0.1:0.1, -0.8, 0.25);
    ico.position.set(side==='left'?-0.65:0.65, 0.95, -0.35);

    root.add(torus, knot, ico);

    // Floating accent bars
    for(let i=0;i<14;i++){
      const plate = new THREE.Mesh(
        new THREE.BoxGeometry(0.04,0.04,0.7),
        new THREE.MeshStandardMaterial({ color: (i%2? 0x69C9D0 : 0xEE1D52), metalness:.35, roughness:.85 })
      );
      const r = 3.6 + Math.random()*0.8;
      const a = Math.random()*Math.PI*2;
      plate.position.set(
        Math.cos(a)*r * (side==='left'?-1:1),
        (Math.random()*2-1)*1.6,
        -0.9 + Math.random()*1.4
      );
      plate.rotation.set(Math.random()*Math.PI, Math.random()*Math.PI, Math.random()*Math.PI);
      root.add(plate);
    }

    // --- Cursor interaction ---
    const target = { rx: 0, ry: 0, cx: camera.position.x, cy: camera.position.y };
    let hovering = false;

    function onPointerMove(e){
      const rect = canvas.getBoundingClientRect();
      const nx = ((e.clientX - rect.left) / rect.width) * 2 - 1;   // -1..1
      const ny = ((e.clientY - rect.top)  / rect.height) * 2 - 1;  // -1..1

      // Desired rotations (small, classy)
      target.ry = nx * 0.35;      // yaw left/right
      target.rx = -ny * 0.25;     // pitch up/down

      // Slight camera parallax for depth
      target.cx = (side==='left' ? 2.4 : -2.4) + nx * (side==='left' ? -0.35 : 0.35);
      target.cy = 0.4 + (-ny) * 0.25;

      hovering = true;
    }

    function onPointerLeave(){
      hovering = false;
      target.rx = 0;
      target.ry = 0;
      target.cx = (side==='left' ? 2.4 : -2.4);
      target.cy = 0.4;
    }

    canvas.addEventListener('pointermove', onPointerMove, { passive:true });
    canvas.addEventListener('pointerleave', onPointerLeave, { passive:true });

    // Resize
    function resize(){
      renderer.setPixelRatio(Math.min(devicePixelRatio, 2));
      renderer.setSize(canvas.clientWidth, canvas.clientHeight, false);
      camera.aspect = Math.max(1e-6, canvas.clientWidth / Math.max(1, canvas.clientHeight));
      camera.updateProjectionMatrix();
    }
    resize(); addEventListener('resize', resize);

    // Scroll coupling
    let scrollProgress = 0;
    function onScroll(){
      const max = document.body.scrollHeight - innerHeight || 1;
      scrollProgress = scrollY / max;
    }
    addEventListener('scroll', onScroll, { passive:true }); onScroll();

    // Animate
    const clock = new THREE.Clock();
    (function tick(){
      const t = clock.getElapsedTime();

      // Ease rotations toward target
      root.rotation.x += (target.rx - root.rotation.x) * 0.08;
      root.rotation.y += (target.ry - root.rotation.y) * 0.08;

      // Add a subtle scroll roll
      root.rotation.z = (side==='left' ? 1 : -1) * scrollProgress * 0.45;

      // Ease camera parallax toward target
      camera.position.x += (target.cx - camera.position.x) * 0.06;
      camera.position.y += (target.cy - camera.position.y) * 0.06;
      camera.lookAt(0,0,0);

      // Idle micro motion keeps it alive even without hover
      const idle = hovering ? 0.2 : 1.0;
      torus.rotation.y += 0.004 * idle + scrollProgress*0.002;
      knot.rotation.x  -= 0.003 * idle + scrollProgress*0.0025;
      ico.rotation.z   += 0.002 * idle + scrollProgress*0.002;

      renderer.render(scene, camera);
      requestAnimationFrame(tick);
    })();
  }
  // Boot rails
  makeRail(document.getElementById('railLeft'),'left');
  makeRail(document.getElementById('railRight'),'right');
</script>

</body>
</html>
